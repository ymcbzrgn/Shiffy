<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shift İncelemesi - Shiffy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        * {
            font-family: 'Manrope', sans-serif;
        }
        
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-slideUp {
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }

        .shift-grid {
            display: grid;
            grid-template-columns: auto repeat(7, 1fr);
            gap: 0.25rem;
            background: white;
            border-radius: 1rem;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            overflow-x: auto;
        }

        .dark .shift-grid {
            background: #1a2a33;
        }

        .grid-header {
            font-weight: 700;
            font-size: 0.75rem;
            color: #617c89;
            text-align: center;
            padding: 0.75rem 0.5rem;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .dark .grid-header {
            color: #a0b8c4;
            background: #1a2a33;
        }

        .employee-name {
            font-weight: 600;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
            position: sticky;
            left: 0;
            background: white;
            z-index: 5;
            white-space: nowrap;
        }

        .dark .employee-name {
            background: #1a2a33;
            color: #f0f3f4;
        }

        .shift-cell {
            min-width: 60px;
            aspect-ratio: 1;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .shift-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .shift-requested {
            background: linear-gradient(135deg, #F0AD4E 0%, #E09E3D 100%);
            color: white;
        }

        .shift-approved {
            background: linear-gradient(135deg, #078836 0%, #056b2a 100%);
            color: white;
        }

        .shift-ai-suggested {
            background: linear-gradient(135deg, #1193d4 0%, #0d7ab8 100%);
            color: white;
            position: relative;
        }

        .shift-ai-suggested::before {
            content: '✨';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
        }

        .shift-empty {
            background: #f6f7f8;
            color: #9ca3af;
        }

        .dark .shift-empty {
            background: #101c22;
            color: #6b7280;
        }

        .ai-badge {
            background: linear-gradient(135deg, #1193d4 0%, #0d7ab8 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.75rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 12px rgba(17, 147, 212, 0.3);
        }

        .stats-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .dark .stats-card {
            background: #1a2a33;
        }
    </style>
</head>
<body class="bg-[#f6f7f8] dark:bg-[#101c22] min-h-screen">
    <!-- Header -->
    <div class="bg-gradient-to-r from-[#1193d4] to-[#0d7ab8] text-white p-6 shadow-lg">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center space-x-3">
                <button onclick="goBack()" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                    <span class="material-symbols-outlined">arrow_back</span>
                </button>
                <div>
                    <h1 class="text-xl font-bold">Shift İncelemesi</h1>
                    <p class="text-sm text-white/80" id="weekRange">22-28 Ocak 2025</p>
                </div>
            </div>
            <button onclick="toggleTheme()" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                <span class="material-symbols-outlined" id="themeIcon">dark_mode</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-6 space-y-6">
        <!-- Week Navigation & AI Toggle -->
        <div class="flex items-center justify-between gap-4 flex-wrap">
            <div class="flex items-center space-x-3">
                <button onclick="previousWeek()" class="p-3 bg-white dark:bg-[#1a2a33] rounded-lg shadow-md hover:shadow-lg transition-all">
                    <span class="material-symbols-outlined text-[#1193d4]">chevron_left</span>
                </button>
                <div class="bg-white dark:bg-[#1a2a33] px-6 py-3 rounded-lg shadow-md">
                    <p class="text-sm font-semibold text-[#111618] dark:text-[#f0f3f4]" id="currentWeek">Hafta 4 - Ocak 2025</p>
                </div>
                <button onclick="nextWeek()" class="p-3 bg-white dark:bg-[#1a2a33] rounded-lg shadow-md hover:shadow-lg transition-all">
                    <span class="material-symbols-outlined text-[#1193d4]">chevron_right</span>
                </button>
            </div>

            <button onclick="toggleAISuggestions()" id="aiToggleBtn" class="ai-badge">
                <span class="material-symbols-outlined">auto_awesome</span>
                <span>AI Önerileri Aktif</span>
            </button>
        </div>

        <!-- Stats Overview -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Toplam İstek</p>
                        <p class="text-2xl font-bold text-[#111618] dark:text-[#f0f3f4]" id="totalRequests">24</p>
                    </div>
                    <div class="bg-[#1193d4]/10 dark:bg-[#1193d4]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#1193d4]">event</span>
                    </div>
                </div>
            </div>

            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Onaylandı</p>
                        <p class="text-2xl font-bold text-[#078836]" id="approvedCount">18</p>
                    </div>
                    <div class="bg-[#078836]/10 dark:bg-[#078836]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#078836]">check_circle</span>
                    </div>
                </div>
            </div>

            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Beklemede</p>
                        <p class="text-2xl font-bold text-[#F0AD4E]" id="pendingCount">6</p>
                    </div>
                    <div class="bg-[#F0AD4E]/10 dark:bg-[#F0AD4E]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#F0AD4E]">hourglass_empty</span>
                    </div>
                </div>
            </div>

            <div class="stats-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">AI Önerisi</p>
                        <p class="text-2xl font-bold text-[#1193d4]" id="aiSuggestions">12</p>
                    </div>
                    <div class="bg-[#1193d4]/10 dark:bg-[#1193d4]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#1193d4]">auto_awesome</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shift Grid -->
        <div class="shift-grid" id="shiftGrid">
            <!-- Grid headers -->
            <div class="grid-header"></div>
            <div class="grid-header">Pzt<br>22</div>
            <div class="grid-header">Sal<br>23</div>
            <div class="grid-header">Çar<br>24</div>
            <div class="grid-header">Per<br>25</div>
            <div class="grid-header">Cum<br>26</div>
            <div class="grid-header">Cmt<br>27</div>
            <div class="grid-header">Paz<br>28</div>

            <!-- Employee rows will be inserted here by JavaScript -->
        </div>

        <!-- Action Buttons -->
        <div class="flex space-x-4">
            <button onclick="approveAll()" class="flex-1 bg-gradient-to-r from-[#078836] to-[#056b2a] text-white py-4 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all flex items-center justify-center space-x-2">
                <span class="material-symbols-outlined">check_circle</span>
                <span>Tümünü Onayla</span>
            </button>
            <button onclick="openEditMode()" class="flex-1 bg-gradient-to-r from-[#1193d4] to-[#0d7ab8] text-white py-4 rounded-xl font-bold shadow-lg hover:shadow-xl transition-all flex items-center justify-center space-x-2">
                <span class="material-symbols-outlined">edit</span>
                <span>Manuel Düzenle</span>
            </button>
        </div>
    </div>

    <!-- Shift Detail Modal -->
    <div id="shiftDetailModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-[#1a2a33] rounded-2xl max-w-md w-full p-6 shadow-2xl animate-slideUp">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold text-[#111618] dark:text-[#f0f3f4]">Shift Detayı</h3>
                <button onclick="closeShiftDetailModal()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors">
                    <span class="material-symbols-outlined text-[#617c89]">close</span>
                </button>
            </div>

            <div class="space-y-4">
                <div class="flex items-center space-x-3">
                    <div class="bg-[#1193d4]/10 dark:bg-[#1193d4]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#1193d4]">person</span>
                    </div>
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Çalışan</p>
                        <p class="font-bold text-[#111618] dark:text-[#f0f3f4]" id="modalEmployeeName">-</p>
                    </div>
                </div>

                <div class="flex items-center space-x-3">
                    <div class="bg-[#1193d4]/10 dark:bg-[#1193d4]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#1193d4]">calendar_today</span>
                    </div>
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Tarih</p>
                        <p class="font-bold text-[#111618] dark:text-[#f0f3f4]" id="modalDate">-</p>
                    </div>
                </div>

                <div class="flex items-center space-x-3">
                    <div class="bg-[#1193d4]/10 dark:bg-[#1193d4]/20 p-3 rounded-lg">
                        <span class="material-symbols-outlined text-[#1193d4]">schedule</span>
                    </div>
                    <div>
                        <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]">Saat</p>
                        <p class="font-bold text-[#111618] dark:text-[#f0f3f4]" id="modalTime">09:00 - 17:00</p>
                    </div>
                </div>

                <div id="aiReasonSection" class="hidden bg-gradient-to-r from-[#1193d4]/10 to-[#1193d4]/5 dark:from-[#1193d4]/20 dark:to-[#1193d4]/10 border-2 border-[#1193d4] rounded-xl p-4">
                    <div class="flex items-start space-x-2">
                        <span class="material-symbols-outlined text-[#1193d4]">auto_awesome</span>
                        <div>
                            <p class="font-bold text-[#111618] dark:text-[#f0f3f4] text-sm mb-1">AI Önerisi</p>
                            <p class="text-xs text-[#617c89] dark:text-[#a0b8c4]" id="aiReason">Bu çalışan bu gün için en yüksek uygunluğa sahip.</p>
                        </div>
                    </div>
                </div>

                <div class="flex space-x-3 pt-4">
                    <button onclick="rejectShift()" class="flex-1 px-6 py-3 border-2 border-[#D9534F] rounded-lg font-semibold text-[#D9534F] hover:bg-[#D9534F]/10 transition-colors">
                        Reddet
                    </button>
                    <button onclick="approveShift()" class="flex-1 px-6 py-3 bg-gradient-to-r from-[#078836] to-[#056b2a] text-white rounded-lg font-bold shadow-lg hover:shadow-xl transition-all">
                        Onayla
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const employees = [
            { id: 1, name: 'Ahmet Ergün', shifts: ['requested', 'approved', 'empty', 'ai-suggested', 'approved', 'requested', 'empty'] },
            { id: 2, name: 'Zeynep Yılmaz', shifts: ['approved', 'empty', 'requested', 'approved', 'empty', 'ai-suggested', 'requested'] },
            { id: 3, name: 'Mehmet Kaya', shifts: ['empty', 'requested', 'approved', 'requested', 'ai-suggested', 'approved', 'empty'] },
            { id: 4, name: 'Ayşe Demir', shifts: ['ai-suggested', 'approved', 'empty', 'approved', 'requested', 'empty', 'requested'] },
            { id: 5, name: 'Can Öztürk', shifts: ['approved', 'requested', 'ai-suggested', 'empty', 'approved', 'requested', 'empty'] }
        ];

        let aiEnabled = true;
        let currentShiftData = null;

        // Theme Management
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            document.getElementById('themeIcon').textContent = isDark ? 'light_mode' : 'dark_mode';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark');
            document.getElementById('themeIcon').textContent = 'light_mode';
        }

        // Navigation
        function goBack() {
            window.location.href = '../yonetici_paneli/yonetici_paneli.html';
        }

        function previousWeek() {
            alert('Önceki hafta yükleniyor...');
        }

        function nextWeek() {
            alert('Sonraki hafta yükleniyor...');
        }

        // AI Toggle
        function toggleAISuggestions() {
            aiEnabled = !aiEnabled;
            const btn = document.getElementById('aiToggleBtn');
            
            if (aiEnabled) {
                btn.innerHTML = '<span class="material-symbols-outlined">auto_awesome</span><span>AI Önerileri Aktif</span>';
            } else {
                btn.innerHTML = '<span class="material-symbols-outlined">auto_awesome</span><span>AI Önerileri Kapalı</span>';
                btn.style.background = 'linear-gradient(135deg, #617c89 0%, #4a5f6b 100%)';
            }
            
            renderShiftGrid();
        }

        // Render Shift Grid
        function renderShiftGrid() {
            const shiftGrid = document.getElementById('shiftGrid');
            
            // Remove existing employee rows
            const existingRows = shiftGrid.querySelectorAll('.employee-row');
            existingRows.forEach(row => row.remove());
            
            employees.forEach((employee, index) => {
                // Employee name cell
                const nameCell = document.createElement('div');
                nameCell.className = 'employee-name employee-row';
                nameCell.textContent = employee.name;
                shiftGrid.appendChild(nameCell);
                
                // Shift cells
                employee.shifts.forEach((shiftType, dayIndex) => {
                    const cell = document.createElement('div');
                    cell.className = 'shift-cell employee-row';
                    
                    if (shiftType === 'empty') {
                        cell.classList.add('shift-empty');
                        cell.innerHTML = '<span>-</span>';
                    } else if (shiftType === 'requested') {
                        cell.classList.add('shift-requested');
                        cell.innerHTML = '<span>09:00</span><span>17:00</span>';
                    } else if (shiftType === 'approved') {
                        cell.classList.add('shift-approved');
                        cell.innerHTML = '<span>✓</span><span class="text-xs">09-17</span>';
                    } else if (shiftType === 'ai-suggested' && aiEnabled) {
                        cell.classList.add('shift-ai-suggested');
                        cell.innerHTML = '<span>09:00</span><span>17:00</span>';
                    } else {
                        cell.classList.add('shift-empty');
                        cell.innerHTML = '<span>-</span>';
                    }
                    
                    if (shiftType !== 'empty') {
                        cell.onclick = () => openShiftDetail(employee, dayIndex, shiftType);
                    }
                    
                    cell.style.animationDelay = `${(index * 7 + dayIndex) * 20}ms`;
                    shiftGrid.appendChild(cell);
                });
            });
        }

        // Open Shift Detail
        function openShiftDetail(employee, dayIndex, shiftType) {
            currentShiftData = { employee, dayIndex, shiftType };
            
            const days = ['Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi', 'Pazar'];
            const dates = ['22 Ocak', '23 Ocak', '24 Ocak', '25 Ocak', '26 Ocak', '27 Ocak', '28 Ocak'];
            
            document.getElementById('modalEmployeeName').textContent = employee.name;
            document.getElementById('modalDate').textContent = `${days[dayIndex]}, ${dates[dayIndex]}`;
            document.getElementById('modalTime').textContent = '09:00 - 17:00';
            
            const aiReasonSection = document.getElementById('aiReasonSection');
            if (shiftType === 'ai-suggested') {
                aiReasonSection.classList.remove('hidden');
                document.getElementById('aiReason').textContent = `${employee.name} bu gün için yüksek uygunluğa sahip. Geçmiş performans ve tercihlerine göre önerildi.`;
            } else {
                aiReasonSection.classList.add('hidden');
            }
            
            document.getElementById('shiftDetailModal').classList.remove('hidden');
        }

        function closeShiftDetailModal() {
            document.getElementById('shiftDetailModal').classList.add('hidden');
            currentShiftData = null;
        }

        function approveShift() {
            if (!currentShiftData) return;
            
            const { employee, dayIndex } = currentShiftData;
            employees.find(e => e.id === employee.id).shifts[dayIndex] = 'approved';
            
            closeShiftDetailModal();
            renderShiftGrid();
            updateStats();
            
            // Show success feedback
            alert(`${employee.name} için shift onaylandı!`);
        }

        function rejectShift() {
            if (!currentShiftData) return;
            
            const { employee, dayIndex } = currentShiftData;
            employees.find(e => e.id === employee.id).shifts[dayIndex] = 'empty';
            
            closeShiftDetailModal();
            renderShiftGrid();
            updateStats();
            
            alert(`${employee.name} için shift reddedildi.`);
        }

        function approveAll() {
            if (!confirm('Tüm bekleyen ve AI önerili shiftleri onaylamak istediğinize emin misiniz?')) return;
            
            employees.forEach(employee => {
                employee.shifts = employee.shifts.map(shift => 
                    (shift === 'requested' || shift === 'ai-suggested') ? 'approved' : shift
                );
            });
            
            renderShiftGrid();
            updateStats();
            alert('Tüm shiftler onaylandı!');
        }

        function openEditMode() {
            alert('Manuel düzenleme modu yakında aktif olacak');
        }

        function updateStats() {
            let totalRequests = 0;
            let approvedCount = 0;
            let pendingCount = 0;
            let aiSuggestions = 0;
            
            employees.forEach(employee => {
                employee.shifts.forEach(shift => {
                    if (shift !== 'empty') totalRequests++;
                    if (shift === 'approved') approvedCount++;
                    if (shift === 'requested') pendingCount++;
                    if (shift === 'ai-suggested') aiSuggestions++;
                });
            });
            
            document.getElementById('totalRequests').textContent = totalRequests;
            document.getElementById('approvedCount').textContent = approvedCount;
            document.getElementById('pendingCount').textContent = pendingCount;
            document.getElementById('aiSuggestions').textContent = aiSuggestions;
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            renderShiftGrid();
            updateStats();
        });
    </script>
</body>
</html>